{"code":"(this[\"webpackJsonpdatathon-ui\"]=this[\"webpackJsonpdatathon-ui\"]||[]).push([[0],{172:function(e,n,t){},173:function(e,n,t){},264:function(e,n,t){\"use strict\";t.r(n);var o=t(6),i=t.n(o),s=t(156),r=t.n(s),a=(t(172),t(173),t(85)),c=t.n(a),l=t(110),u=t(166),h=t(160),d=t(161),p=t(162),f=t(163),T=t(86),E=t(167),v=t(165),b=t(67),g=t.n(b),A=t(164),O=t.n(A),C=t(17),R=\"[CONFIDENTIAL]\",_=new O.a;t(182).config();var S=t(186),j=S.Configuration,N=S.OpenAIApi,m=t(217),P=m.driver(\"neo4j+s://f79205bc.databases.neo4j.io:7687\",m.auth.basic(\"neo4j\",\"kLy2ToqJaVO6OZmJ3fR3ETKhxB7-KmBLfqSdkwClVYs\")).session({database:Object({NODE_ENV:\"production\",PUBLIC_URL:\"\",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NEO4JPASSWORD:\"kLy2ToqJaVO6OZmJ3fR3ETKhxB7-KmBLfqSdkwClVYs\",REACT_APP_NEO4JURI:\"neo4j+s://f79205bc.databases.neo4j.io:7687\",REACT_APP_NEO4JUSER:\"neo4j\",REACT_APP_OPENAI_API_KEY:\"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\"}).REACT_APP_NEO4JDATABASE||\"neo4j\"}),y=new N(new j({apiKey:Object({NODE_ENV:\"production\",PUBLIC_URL:\"\",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NEO4JPASSWORD:\"kLy2ToqJaVO6OZmJ3fR3ETKhxB7-KmBLfqSdkwClVYs\",REACT_APP_NEO4JURI:\"neo4j+s://f79205bc.databases.neo4j.io:7687\",REACT_APP_NEO4JUSER:\"neo4j\",REACT_APP_OPENAI_API_KEY:\"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\"}).REACT_APP_API_KEY}));_.init({volume:1,lang:\"en-GB\",rate:1,pitch:1,voice:\"Google UK English Male\",splitSentences:!0,listeners:{onvoiceschanged:function(e){console.log(\"Event voiceschanged\",e)}}});var x=function(e){Object(E.a)(t,e);var n=Object(v.a)(t);function t(e){var o;return Object(p.a)(this,t),(o=n.call(this,e)).state={loading:!0,result:\"\"},o.triggetNext=o.triggetNext.bind(Object(T.a)(o)),o}return Object(f.a)(t,[{key:\"callMoviesBot\",value:function(){var e=this,n=this.props.steps.user.value;function t(){return(t=Object(d.a)(g.a.mark((function t(){var o,i,s,r,a,c,l;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if('\\n      #Which library collections are included in this archive?\\n      MATCH(n:`Library Collection`)\\n      RETURN n.Title;\\n      \\n      #Who is interviewed most often in the archive?\\n      MATCH (n)-[r:interviewee]->()\\n      RETURN n, COUNT(r) AS numRels\\n      ORDER BY numRels DESC\\n      LIMIT 1\\n      \\n      #How many issues of The Real News are in this archive?\\n      MATCH (n:Collection_items)\\n      WHERE n.Title CONTAINS \"The Real News\"\\n      RETURN count(n)\\n      #',o='\\n      #Which library collections are included in this archive?\\n      MATCH(n:`Library Collection`)\\n      RETURN n.Title;\\n      \\n      #Who is interviewed most often in the archive?\\n      MATCH (n)-[r:interviewee]->()\\n      RETURN n, COUNT(r) AS numRels\\n      ORDER BY numRels DESC\\n      LIMIT 1\\n      \\n      #How many issues of The Real News are in this archive?\\n      MATCH (n:Collection_items)\\n      WHERE n.Title CONTAINS \"The Real News\"\\n      RETURN count(n)\\n      #'+n+\"\\n\",i=\"\",t.prev=3,console.log(\"query\",o),!n){t.next=22;break}return t.next=8,y.createCompletion(\"davinci\",{prompt:o,temperature:0,max_tokens:150,top_p:1,frequency_penalty:0,presence_penalty:0,stop:[\"#\",\";\"]});case 8:return s=t.sent,console.log(\"response:\",s),r=s.data.choices[0].text,console.log(\"MoviesBot:\"+r),t.prev=12,t.next=15,P.run(r);case 15:a=t.sent,(c=a.records).forEach((function(e){i+=e.get(0)+\", \"})),i=i.slice(0,-2),console.log(\"records\",c);case 20:return t.prev=20,t.finish(20);case 22:t.next=29;break;case 24:t.prev=24,t.t0=t.catch(3),console.error(t.t0),console.log(\"MoviesBot:\"+i),i=\"Sorry I can't answer that. Could you please try again?\";case 29:l=!1,i.startsWith(R)&&(l=!0),e.setState({loading:!1,result:i}),l||i.length>115?_.speak({text:\"Please find the information below\"}).then((function(){console.log(\"Success !\")})).catch((function(e){console.error(\"An error occurred :\",e)})):_.speak({text:i}).then((function(){console.log(\"Success !\")})).catch((function(e){console.error(\"An error occurred :\",e)}));case 33:case\"end\":return t.stop()}}),t,null,[[3,24],[12,,20,22]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}},{key:\"triggetNext\",value:function(){var e=this;this.setState({},(function(){e.props.triggerNextStep()}))}},{key:\"componentDidMount\",value:function(){this.callMoviesBot(),this.triggetNext()}},{key:\"render\",value:function(){var e,n=this.state,t=n.loading,o=n.result.split(\"\\n\"),i=[],s=Object(h.a)(o.entries());try{for(s.s();!(e=s.n()).done;){var r=Object(u.a)(e.value,2),c=r[0],l=r[1];i.push(Object(C.jsxs)(\"span\",{children:[l,Object(C.jsx)(\"br\",{})]},c))}}catch(d){s.e(d)}finally{s.f()}return Object(C.jsx)(\"div\",{className:\"bot-response\",children:t?Object(C.jsx)(a.Loading,{}):i})}}]),t}(o.Component);x.defaultProps={steps:void 0,triggerNextStep:void 0};var w=x,k={background:\"#f5f8fb\",fontFamily:\"Tahoma\",headerBgColor:\"#0066ff\",headerFontColor:\"#fff\",headerFontSize:\"15px\",botBubbleColor:\"#3399ff\",botFontColor:\"#fff\",userBubbleColor:\"#fff\",userFontColor:\"#4a4a4a\"},B=[{id:\"bot-welcome\",message:\"Welcome to Digital Traces bot, how can I help?\",trigger:\"user\"},{id:\"user\",user:!0,trigger:\"bot-response\"},{id:\"bot-response\",component:Object(C.jsx)(w,{}),waitAction:!0,asMessage:!0,trigger:\"user\"},{id:\"not-bye\",message:\"Thank you. Have a great day!\",end:!0}];var D=function(){var e=Object(C.jsx)(c.a,{steps:B,headerTitle:\"Digital Traces Bot\",botAvatar:\"ai_trans.png\",userAvatar:\"user.png\",recognitionEnable:!0,width:\"450px\",speechSynthesis:{enable:!1,lang:\"en\"}});return Object(C.jsx)(\"div\",{className:\"App\",style:{display:\"flex\",justifyContent:\"center\"},children:\"\"!==k?Object(C.jsxs)(l.ThemeProvider,{theme:k,children:[\" \",e,\" \"]}):e})},I=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,265)).then((function(n){var t=n.getCLS,o=n.getFID,i=n.getFCP,s=n.getLCP,r=n.getTTFB;t(e),o(e),i(e),s(e),r(e)}))};r.a.render(Object(C.jsx)(i.a.StrictMode,{children:Object(C.jsx)(D,{})}),document.getElementById(\"root\")),I(console.log)}},[[264,1,2]]]);","name":"static/js/main.dfef9a96.chunk.js","map":{"version":3,"sources":["static/js/main.dfef9a96.chunk.js"],"names":["this","push","module","exports","__webpack_require__","__webpack_exports__","r","react","react_default","n","react_dom","react_dom_default","react_simple_chatbot","react_simple_chatbot_default","styled_components_browser_esm","slicedToArray","createForOfIteratorHelper","asyncToGenerator","classCallCheck","createClass","assertThisInitialized","inherits","createSuper","regenerator","regenerator_default","speak_tts","speak_tts_default","jsx_runtime","CONFIDENTIAL","speech","a","config","_require","Configuration","OpenAIApi","neo4j","session","driver","auth","basic","database","Object","NODE_ENV","PUBLIC_URL","WDS_SOCKET_HOST","undefined","WDS_SOCKET_PATH","WDS_SOCKET_PORT","FAST_REFRESH","REACT_APP_NEO4JPASSWORD","REACT_APP_NEO4JURI","REACT_APP_NEO4JUSER","REACT_APP_OPENAI_API_KEY","REACT_APP_NEO4JDATABASE","openai","apiKey","REACT_APP_API_KEY","init","volume","lang","rate","pitch","voice","splitSentences","listeners","onvoiceschanged","voices","console","log","moviesbot_gpt3_MoviesBot","_Component","MoviesBot","_super","props","_this","call","state","loading","result","triggetNext","bind","key","value","self","search","steps","user","_callAsync","mark","_callee","query","textToSpeak","response","cypher","records","isConfidential","wrap","_context","prev","next","createCompletion","prompt","temperature","max_tokens","top_p","frequency_penalty","presence_penalty","stop","sent","data","choices","text","run","forEach","element","get","slice","finish","t0","error","startsWith","setState","length","speak","then","catch","e","apply","arguments","callAsync","_this2","triggerNextStep","callMoviesBot","_step","_this$state","lines","split","elements","_iterator","entries","s","done","_step$value","index","children","err","f","className","defaultProps","moviesbot_gpt3","theme","background","fontFamily","headerBgColor","headerFontColor","headerFontSize","botBubbleColor","botFontColor","userBubbleColor","userFontColor","App_steps","id","message","trigger","component","waitAction","asMessage","end","src_App","chatbot","headerTitle","botAvatar","userAvatar","recognitionEnable","width","speechSynthesis","enable","style","display","justifyContent","src_reportWebVitals","onPerfEntry","Function","_ref","getCLS","getFID","getFCP","getLCP","getTTFB","render","StrictMode","document","getElementById"],"mappings":"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"},"input":"(this[\"webpackJsonpdatathon-ui\"] = this[\"webpackJsonpdatathon-ui\"] || []).push([[0],{\n\n/***/ 172:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 173:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 264:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(6);\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(156);\nvar react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);\n\n// EXTERNAL MODULE: ./src/index.css\nvar src = __webpack_require__(172);\n\n// EXTERNAL MODULE: ./src/App.css\nvar App = __webpack_require__(173);\n\n// EXTERNAL MODULE: ./node_modules/react-simple-chatbot/dist/react-simple-chatbot.js\nvar react_simple_chatbot = __webpack_require__(85);\nvar react_simple_chatbot_default = /*#__PURE__*/__webpack_require__.n(react_simple_chatbot);\n\n// EXTERNAL MODULE: ./node_modules/styled-components/dist/styled-components.browser.esm.js\nvar styled_components_browser_esm = __webpack_require__(110);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules\nvar slicedToArray = __webpack_require__(166);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\nvar createForOfIteratorHelper = __webpack_require__(160);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(161);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/classCallCheck.js\nvar classCallCheck = __webpack_require__(162);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createClass.js\nvar createClass = __webpack_require__(163);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\nvar assertThisInitialized = __webpack_require__(86);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/inherits.js + 1 modules\nvar inherits = __webpack_require__(167);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createSuper.js + 4 modules\nvar createSuper = __webpack_require__(165);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/regenerator/index.js\nvar regenerator = __webpack_require__(67);\nvar regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);\n\n// EXTERNAL MODULE: ./node_modules/speak-tts/lib/speak-tts.js\nvar speak_tts = __webpack_require__(164);\nvar speak_tts_default = /*#__PURE__*/__webpack_require__.n(speak_tts);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(17);\n\n// CONCATENATED MODULE: ./src/component/moviesbot_gpt3.js\nvar CONFIDENTIAL=\"[CONFIDENTIAL]\";var speech=new speak_tts_default.a();__webpack_require__(182).config();var _require=__webpack_require__(186),Configuration=_require.Configuration,OpenAIApi=_require.OpenAIApi;var neo4j=__webpack_require__(217);var driver=neo4j.driver(\"neo4j+s://f79205bc.databases.neo4j.io:7687\",neo4j.auth.basic(\"neo4j\",\"kLy2ToqJaVO6OZmJ3fR3ETKhxB7-KmBLfqSdkwClVYs\"));var session=driver.session({database:Object({\"NODE_ENV\":\"production\",\"PUBLIC_URL\":\"\",\"WDS_SOCKET_HOST\":undefined,\"WDS_SOCKET_PATH\":undefined,\"WDS_SOCKET_PORT\":undefined,\"FAST_REFRESH\":true,\"REACT_APP_NEO4JPASSWORD\":\"kLy2ToqJaVO6OZmJ3fR3ETKhxB7-KmBLfqSdkwClVYs\",\"REACT_APP_NEO4JURI\":\"neo4j+s://f79205bc.databases.neo4j.io:7687\",\"REACT_APP_NEO4JUSER\":\"neo4j\",\"REACT_APP_OPENAI_API_KEY\":\"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\"}).REACT_APP_NEO4JDATABASE||'neo4j'});var configuration=new Configuration({apiKey:Object({\"NODE_ENV\":\"production\",\"PUBLIC_URL\":\"\",\"WDS_SOCKET_HOST\":undefined,\"WDS_SOCKET_PATH\":undefined,\"WDS_SOCKET_PORT\":undefined,\"FAST_REFRESH\":true,\"REACT_APP_NEO4JPASSWORD\":\"kLy2ToqJaVO6OZmJ3fR3ETKhxB7-KmBLfqSdkwClVYs\",\"REACT_APP_NEO4JURI\":\"neo4j+s://f79205bc.databases.neo4j.io:7687\",\"REACT_APP_NEO4JUSER\":\"neo4j\",\"REACT_APP_OPENAI_API_KEY\":\"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\"}).REACT_APP_API_KEY});var openai=new OpenAIApi(configuration);speech.init({'volume':1,'lang':'en-GB','rate':1,'pitch':1,'voice':'Google UK English Male','splitSentences':true,'listeners':{'onvoiceschanged':function onvoiceschanged(voices){console.log(\"Event voiceschanged\",voices);}}});var moviesbot_gpt3_MoviesBot=/*#__PURE__*/function(_Component){Object(inherits[\"a\" /* default */])(MoviesBot,_Component);var _super=Object(createSuper[\"a\" /* default */])(MoviesBot);function MoviesBot(props){var _this;Object(classCallCheck[\"a\" /* default */])(this,MoviesBot);_this=_super.call(this,props);_this.state={loading:true,result:''};_this.triggetNext=_this.triggetNext.bind(Object(assertThisInitialized[\"a\" /* default */])(_this));return _this;}Object(createClass[\"a\" /* default */])(MoviesBot,[{key:\"callMoviesBot\",value:function callMoviesBot(){var self=this;var steps=this.props.steps;var search=steps.user.value;function callAsync(){return _callAsync.apply(this,arguments);}function _callAsync(){_callAsync=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var training,query,textToSpeak,response,cypher,result,records,isConfidential;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:training=\"\\n      #Which library collections are included in this archive?\\n      MATCH(n:`Library Collection`)\\n      RETURN n.Title;\\n      \\n      #Who is interviewed most often in the archive?\\n      MATCH (n)-[r:interviewee]->()\\n      RETURN n, COUNT(r) AS numRels\\n      ORDER BY numRels DESC\\n      LIMIT 1\\n      \\n      #How many issues of The Real News are in this archive?\\n      MATCH (n:Collection_items)\\n      WHERE n.Title CONTAINS \\\"The Real News\\\"\\n      RETURN count(n)\\n      #\";query=training+search+\"\\n\";textToSpeak='';_context.prev=3;console.log(\"query\",query);if(!search){_context.next=22;break;}_context.next=8;return openai.createCompletion(\"davinci\",{prompt:query,temperature:0,max_tokens:150,top_p:1.0,frequency_penalty:0.0,presence_penalty:0.0,stop:[\"#\",\";\"]});case 8:response=_context.sent;console.log('response:',response);cypher=response.data.choices[0].text;console.log('MoviesBot:'+cypher);_context.prev=12;_context.next=15;return session.run(cypher);case 15:result=_context.sent;//const singleRecord = result.records[0]\nrecords=result.records;records.forEach(function(element){textToSpeak+=element.get(0)+\", \";});//textToSpeak = singleRecord.get(0)\ntextToSpeak=textToSpeak.slice(0,-2);console.log(\"records\",records);case 20:_context.prev=20;return _context.finish(20);case 22:_context.next=29;break;case 24:_context.prev=24;_context.t0=_context[\"catch\"](3);//console.log(process.env);\nconsole.error(_context.t0);console.log('MoviesBot:'+textToSpeak);textToSpeak=\"Sorry I can't answer that. Could you please try again?\";case 29:isConfidential=false;if(textToSpeak.startsWith(CONFIDENTIAL)){isConfidential=true;// textToSpeak = textToSpeak.substring(CONFIDENTIAL.length)\n}self.setState({loading:false,result:textToSpeak});if(isConfidential||textToSpeak.length>115){speech.speak({text:\"Please find the information below\"}).then(function(){console.log(\"Success !\");}).catch(function(e){console.error(\"An error occurred :\",e);});}else{speech.speak({text:textToSpeak}).then(function(){console.log(\"Success !\");}).catch(function(e){console.error(\"An error occurred :\",e);});}case 33:case\"end\":return _context.stop();}}},_callee,null,[[3,24],[12,,20,22]]);}));return _callAsync.apply(this,arguments);}callAsync();}},{key:\"triggetNext\",value:function triggetNext(){var _this2=this;this.setState({},function(){_this2.props.triggerNextStep();});}},{key:\"componentDidMount\",value:function componentDidMount(){this.callMoviesBot();this.triggetNext();}},{key:\"render\",value:function render(){var _this$state=this.state,loading=_this$state.loading,result=_this$state.result;var lines=result.split(\"\\n\");var elements=[];var _iterator=Object(createForOfIteratorHelper[\"a\" /* default */])(lines.entries()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=Object(slicedToArray[\"a\" /* default */])(_step.value,2),index=_step$value[0],value=_step$value[1];elements.push(/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"span\",{children:[value,/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"br\",{})]},index));}}catch(err){_iterator.e(err);}finally{_iterator.f();}return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"bot-response\",children:loading?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_simple_chatbot[\"Loading\"],{}):elements});}}]);return MoviesBot;}(react[\"Component\"]);moviesbot_gpt3_MoviesBot.defaultProps={steps:undefined,triggerNextStep:undefined};/* harmony default export */ var moviesbot_gpt3 = (moviesbot_gpt3_MoviesBot);\n// CONCATENATED MODULE: ./src/App.js\nvar ENABLE_THEME=true;var theme_red={background:'#f5f8fb',fontFamily:'Tahoma',headerBgColor:'#0066ff',headerFontColor:'#fff',headerFontSize:'15px',botBubbleColor:'#3399ff',botFontColor:'#fff',userBubbleColor:'#fff',userFontColor:'#4a4a4a'};var theme=ENABLE_THEME?theme_red:'';var App_steps=[{id:'bot-welcome',message:'Welcome to Digital Traces bot, how can I help?',trigger:'user'},{id:'user',user:true,trigger:'bot-response'},{id:'bot-response',component:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(moviesbot_gpt3,{}),waitAction:true,asMessage:true,trigger:'user'},{id:'not-bye',message:'Thank you. Have a great day!',end:true}];function App_App(){var chatbot=/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_simple_chatbot_default.a,{steps:App_steps,headerTitle:\"Digital Traces Bot\",botAvatar:\"ai_trans.png\",userAvatar:\"user.png\",recognitionEnable:true,width:\"450px\",speechSynthesis:{enable:false,lang:'en'}});return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"App\",style:{display:'flex',justifyContent:'center'},children:theme!==''?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(styled_components_browser_esm[\"ThemeProvider\"],{theme:theme,children:[\" \",chatbot,\" \"]}):chatbot});}/* harmony default export */ var src_App = (App_App);\n// CONCATENATED MODULE: ./src/reportWebVitals.js\nvar reportWebVitals=function reportWebVitals(onPerfEntry){if(onPerfEntry&&onPerfEntry instanceof Function){__webpack_require__.e(/* import() */ 3).then(__webpack_require__.bind(null, 265)).then(function(_ref){var getCLS=_ref.getCLS,getFID=_ref.getFID,getFCP=_ref.getFCP,getLCP=_ref.getLCP,getTTFB=_ref.getTTFB;getCLS(onPerfEntry);getFID(onPerfEntry);getFCP(onPerfEntry);getLCP(onPerfEntry);getTTFB(onPerfEntry);});}};/* harmony default export */ var src_reportWebVitals = (reportWebVitals);\n// CONCATENATED MODULE: ./src/index.js\nreact_dom_default.a.render(/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_default.a.StrictMode,{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(src_App,{})}),document.getElementById('root'));// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nsrc_reportWebVitals(console.log);\n\n/***/ })\n\n},[[264,1,2]]]);","inputSourceMap":{"version":3,"sources":["C:\\Stanford\\DigitalTracesApp3\\node_modules\\mini-css-extract-plugin\\dist\\loader.js??ref--5-oneOf-4-0!C:\\Stanford\\DigitalTracesApp3\\node_modules\\css-loader\\dist\\cjs.js??ref--5-oneOf-4-1!C:\\Stanford\\DigitalTracesApp3\\node_modules\\postcss-loader\\src\\index.js??postcss!C:\\Stanford\\DigitalTracesApp3\\src\\index.css","C:\\Stanford\\DigitalTracesApp3\\node_modules\\mini-css-extract-plugin\\dist\\loader.js??ref--5-oneOf-4-0!C:\\Stanford\\DigitalTracesApp3\\node_modules\\css-loader\\dist\\cjs.js??ref--5-oneOf-4-1!C:\\Stanford\\DigitalTracesApp3\\node_modules\\postcss-loader\\src\\index.js??postcss!C:\\Stanford\\DigitalTracesApp3\\src\\App.css","C:/Stanford/DigitalTracesApp3/src/component/moviesbot_gpt3.js","C:/Stanford/DigitalTracesApp3/src/App.js","C:/Stanford/DigitalTracesApp3/src/reportWebVitals.js","C:/Stanford/DigitalTracesApp3/src/index.js"],"names":["CONFIDENTIAL","speech","Speech","require","config","_require","Configuration","OpenAIApi","neo4j","driver","process","auth","basic","session","database","REACT_APP_NEO4JDATABASE","configuration","apiKey","REACT_APP_API_KEY","openai","init","onvoiceschanged","voices","console","log","MoviesBot","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","state","loading","result","triggetNext","bind","_assertThisInitialized","_createClass","key","value","callMoviesBot","self","steps","search","user","callAsync","_callAsync","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","training","query","textToSpeak","response","cypher","records","isConfidential","wrap","_callee$","_context","prev","next","createCompletion","prompt","temperature","max_tokens","top_p","frequency_penalty","presence_penalty","stop","sent","data","choices","text","run","forEach","element","get","slice","finish","t0","error","startsWith","setState","length","speak","then","catch","e","_this2","triggerNextStep","componentDidMount","render","_this$state","lines","split","elements","_iterator","_createForOfIteratorHelper","entries","_step","s","n","done","_step$value","_slicedToArray","index","push","_jsxs","children","_jsx","err","f","className","Loading","Component","defaultProps","undefined","ENABLE_THEME","theme_red","background","fontFamily","headerBgColor","headerFontColor","headerFontSize","botBubbleColor","botFontColor","userBubbleColor","userFontColor","theme","id","message","trigger","component","waitAction","asMessage","end","App","chatbot","ChatBot","headerTitle","botAvatar","userAvatar","recognitionEnable","width","speechSynthesis","enable","lang","style","display","justifyContent","ThemeProvider","reportWebVitals","onPerfEntry","Function","_ref","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","React","StrictMode","document","getElementById"],"mappings":"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","file":"x","sourcesContent":["// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Loading } from 'react-simple-chatbot';\n\nimport Speech from 'speak-tts'\n\n\nconst CONFIDENTIAL = \"[CONFIDENTIAL]\";\nconst speech = new Speech()\nrequire('dotenv').config()\n\n\nconst { Configuration, OpenAIApi } = require(\"openai\");\nconst neo4j = require('neo4j-driver')\n\nconst driver = neo4j.driver(process.env.REACT_APP_NEO4JURI, neo4j.auth.basic(process.env.REACT_APP_NEO4JUSER, process.env.REACT_APP_NEO4JPASSWORD))\n\nconst session = driver.session({database:process.env.REACT_APP_NEO4JDATABASE || 'neo4j'})\n\n\n\n\nconst configuration = new Configuration({\n  apiKey: process.env.REACT_APP_API_KEY\n});\n\nconst openai = new OpenAIApi(configuration);\n\n\nspeech.init({\n  'volume': 1,\n  'lang': 'en-GB',\n  'rate': 1,\n  'pitch': 1,\n  'voice': 'Google UK English Male',\n  'splitSentences': true,\n  'listeners': {\n    'onvoiceschanged': (voices) => {\n      console.log(\"Event voiceschanged\", voices)\n    }\n  }\n})\n\nclass MoviesBot extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      loading: true,\n      result: ''\n    };\n\n    this.triggetNext = this.triggetNext.bind(this);\n  }\n\n  callMoviesBot() {\n\n    const self = this;\n    const { steps } = this.props;\n    const search = steps.user.value;\n\n    async function callAsync() {\n      let training = `\n      #Which library collections are included in this archive?\n      MATCH(n:\\`Library Collection\\`)\n      RETURN n.Title;\n      \n      #Who is interviewed most often in the archive?\n      MATCH (n)-[r:interviewee]->()\n      RETURN n, COUNT(r) AS numRels\n      ORDER BY numRels DESC\n      LIMIT 1\n      \n      #How many issues of The Real News are in this archive?\n      MATCH (n:Collection_items)\n      WHERE n.Title CONTAINS \"The Real News\"\n      RETURN count(n)\n      #`;\n\n\n\n      let query = training + search + \"\\n\"\n\n      let textToSpeak = ''\n      try {\n        console.log(\"query\", query)\n        if (search) {\n\n          const response = await openai.createCompletion(\"davinci\", {\n            prompt: query,\n            temperature: 0,\n            max_tokens: 150,\n            top_p: 1.0,\n            frequency_penalty: 0.0,\n            presence_penalty: 0.0,\n            stop: [\"#\", \";\"],\n          });\n\n          console.log('response:', response);\n          let cypher = response.data.choices[0].text;\n          console.log('MoviesBot:' + cypher);\n\n          try {\n            const result = await session.run(cypher)\n\n            //const singleRecord = result.records[0]\n\n            const records = result.records\n\n            records.forEach(element => {\n              textToSpeak += element.get(0) + \", \"\n            });\n\n            //textToSpeak = singleRecord.get(0)\n            textToSpeak = textToSpeak.slice(0, -2)\n\n            console.log(\"records\", records)\n          } finally {\n            //await session.close()\n          }\n\n          // on application exit:\n          //await driver.close()\n        }\n      }\n      catch (error) {\n        //console.log(process.env);\n        console.error(error)\n        console.log('MoviesBot:' + textToSpeak);\n        textToSpeak = \"Sorry I can't answer that. Could you please try again?\"\n      }\n\n      let isConfidential = false;\n      if (textToSpeak.startsWith(CONFIDENTIAL)) {\n        isConfidential = true;\n        // textToSpeak = textToSpeak.substring(CONFIDENTIAL.length)\n      }\n\n      self.setState({ loading: false, result: textToSpeak });\n\n      if (isConfidential || textToSpeak.length > 115) {\n        speech.speak({ text: \"Please find the information below\" })\n          .then(() => { console.log(\"Success !\") })\n          .catch(e => { console.error(\"An error occurred :\", e) })\n      } else {\n        speech.speak({ text: textToSpeak })\n          .then(() => { console.log(\"Success !\") })\n          .catch(e => { console.error(\"An error occurred :\", e) })\n      }\n\n    }\n    callAsync();\n  }\n\n  triggetNext() {\n    this.setState({}, () => {\n      this.props.triggerNextStep();\n    });\n  }\n\n  componentDidMount() {\n    this.callMoviesBot();\n    this.triggetNext();\n  }\n\n  render() {\n    const { loading, result } = this.state;\n    const lines = result.split(\"\\n\");\n    const elements = [];\n    for (const [index, value] of lines.entries()) {\n      elements.push(<span key={index}>{value}<br /></span>)\n    }\n\n    return (\n      <div className=\"bot-response\">\n        {loading ? <Loading /> : elements}\n      </div>\n    );\n  }\n}\n\nMoviesBot.propTypes = {\n  steps: PropTypes.object,\n  triggerNextStep: PropTypes.func,\n};\n\nMoviesBot.defaultProps = {\n  steps: undefined,\n  triggerNextStep: undefined,\n};\n\nexport default MoviesBot;\n","import './App.css';\nimport ChatBot from 'react-simple-chatbot';\nimport { ThemeProvider } from 'styled-components';\nimport MoviesBot from './component/moviesbot_gpt3';\n\n\nconst ENABLE_THEME = true\n\nconst theme_red = {\n  background: '#f5f8fb',\n  fontFamily: 'Tahoma',\n  headerBgColor: '#0066ff',\n  headerFontColor: '#fff',\n  headerFontSize: '15px',\n  botBubbleColor: '#3399ff',\n  botFontColor: '#fff',\n  userBubbleColor: '#fff',\n  userFontColor: '#4a4a4a',\n};\n\nconst theme = ENABLE_THEME ? theme_red : ''\n\nconst steps = [\n  {\n    id: 'bot-welcome',\n    message: 'Welcome to Digital Traces bot, how can I help?',\n    trigger: 'user'\n  },\n  {\n    id: 'user',\n    user: true,\n    trigger: 'bot-response'\n  },\n  {\n    id: 'bot-response',\n    component: <MoviesBot />,\n    waitAction: true,\n    asMessage: true,\n    trigger: 'user'\n  },\n  {\n    id: 'not-bye',\n    message: 'Thank you. Have a great day!',\n    end: true\n  },\n];\n\nfunction App() {\n  let chatbot = <ChatBot\n    steps={steps}\n    headerTitle=\"Digital Traces Bot\"\n    botAvatar=\"ai_trans.png\"\n    userAvatar=\"user.png\"\n    recognitionEnable={true}\n    width=\"450px\"\n    speechSynthesis={{ enable: false, lang: 'en' }}\n  />\n\n  return (\n    <div className=\"App\" style={{display: 'flex', justifyContent: 'center'}}>\n      {\n         (theme !== '') ? <ThemeProvider theme={theme}> {chatbot} </ThemeProvider> : chatbot\n      }\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals(console.log);\n"]}}